<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>CoHealth â€“ Ø§Ù„Ù…Ø±Ø¶Ù‰</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {

      window.searchPatients = function () {
        const input = document.getElementById("searchInput").value
          .toLowerCase()
          .trim();

        const rows = document.querySelectorAll(".patient-row");

        rows.forEach(row => {
          const name = row.querySelector(".patient-name").textContent.toLowerCase();
          const phone = row.querySelector(".patient-phone").textContent.toLowerCase();

          if (input === "") {
            row.style.display = "";
          } else if (name.includes(input) || phone.includes(input)) {
            row.style.display = "";
          } else {
            row.style.display = "none";
          }
        });
      };

      window.clearSearch = function () {
        document.getElementById("searchInput").value = "";
        searchPatients();
      };

      window.handleEnter = function (e) {
        if (e.key === "Enter") {
          e.preventDefault();
          searchPatients();
        }
      };

    });
  </script>
</head>

<body dir="rtl" class="bg-gray-100">

<!-- Navbar -->
<nav class="bg-blue-600 p-4">
  <div class="max-w-7xl mx-auto flex justify-between text-white">
    <a href="{{ url_for('home') }}" class="text-2xl font-bold">CoHealth</a>
    <div class="space-x-6">
      <a href="{{ url_for('home') }}">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="{{ url_for('services') }}">Ø§Ù„Ø®Ø¯Ù…Ø§Øª</a>
      <a href="{{ url_for('patients') }}" class="font-semibold">Ø§Ù„Ù…Ø±Ø¶Ù‰</a>
      <a href="{{ url_for('logout') }}">Ø®Ø±ÙˆØ¬</a>
    </div>
  </div>
</nav>

<div class="max-w-7xl mx-auto mt-8 px-4">

  <!-- ğŸ” Ø§Ù„Ø¨Ø­Ø« (ÙÙˆÙƒ) -->
  <div class="bg-white p-4 rounded shadow mb-6 flex gap-2">
    <input
      id="searchInput"
      type="text"
      onkeydown="handleEnter(event)"
      placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
      class="flex-1 border p-2 rounded">

    <button onclick="searchPatients()"
      class="bg-blue-600 text-white px-4 rounded">
      Ø¨Ø­Ø«
    </button>

    <button onclick="clearSearch()"
      class="bg-gray-500 text-white px-4 rounded">
      Ù…Ø³Ø­
    </button>
  </div>

  <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ -->
  <div class="bg-white p-6 rounded shadow mb-6">
    <h2 class="text-xl font-bold text-blue-700 mb-4">Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯</h2>

    <form method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <input name="name" required placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="border p-2 rounded">
      <input name="age" type="number" required placeholder="Ø§Ù„Ø¹Ù…Ø±" class="border p-2 rounded">

      <select name="gender" required class="border p-2 rounded">
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³</option>
        <option value="Male">Ø°ÙƒØ±</option>
        <option value="Female">Ø£Ù†Ø«Ù‰</option>
      </select>

      <input name="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" class="border p-2 rounded">
      <textarea name="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª" class="border p-2 rounded md:col-span-2"></textarea>

      <button class="bg-blue-600 text-white py-2 rounded md:col-span-2">
        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙŠØ¶
      </button>
    </form>
  </div>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø±Ø¶Ù‰ -->
  <div class="bg-white p-6 rounded shadow">
    <h2 class="text-xl font-bold text-blue-700 mb-4">Ø³Ø¬Ù„ Ø§Ù„Ù…Ø±Ø¶Ù‰</h2>

    <table class="w-full border">
      <thead class="bg-blue-50">
        <tr>
          <th class="p-2">Ø§Ù„Ø§Ø³Ù…</th>
          <th class="p-2">Ø§Ù„Ø¹Ù…Ø±</th>
          <th class="p-2">Ø§Ù„Ø¬Ù†Ø³</th>
          <th class="p-2">Ø§Ù„Ù‡Ø§ØªÙ</th>
          <th class="p-2">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
          <th class="p-2">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
        </tr>
      </thead>

      <tbody>
        {% for patient in patients %}
        <tr class="patient-row border-t">
          <td class="p-2 patient-name">{{ patient.name }}</td>
          <td class="p-2">{{ patient.age }}</td>
          <td class="p-2">{{ 'Ø°ÙƒØ±' if patient.gender=='Male' else 'Ø£Ù†Ø«Ù‰' }}</td>
          <td class="p-2 patient-phone">{{ patient.phone }}</td>
          <td class="p-2">{{ patient.notes }}</td>
          <td class="p-2">{{ patient.created_at.strftime('%Y-%m-%d') }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="6" class="text-center p-4 text-gray-500">
            Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø±Ø¶Ù‰
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

</body>
</html>
